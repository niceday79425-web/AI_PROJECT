<!DOCTYPE html>
<html lang="pt">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StockWise | Dividendos Premium</title>
    <link rel="stylesheet" href="../css/style.css">
</head>

<body>
    <div class="container">
        <header>
            <a href="/pt/" class="logo">StockWise.ai</a>
            <nav class="lang-selector">
                <a href="/ko/list.html" class="lang-link">KO</a>
                <a href="/list.html" class="lang-link">EN</a>
                <a href="/pt/list.html" class="lang-link active">PT</a>
            </nav>
        </header>
        <div class="ad-slot"></div>
        <main>
            <section class="card">
                <h2>üèÜ Insights de Dividendos Premium</h2>
                <p style="color: var(--text-secondary); margin-bottom: 2rem;">
                    Analise mais de 50 a√ß√µes de dividendos com nosso sistema exclusivo de classifica√ß√£o.
                </p>

                <!-- Controls -->
                <div style="display: flex; gap: 1rem; margin-bottom: 1.5rem; flex-wrap: wrap;">
                    <input type="text" id="searchBox" placeholder="Pesquisar por ticker ou nome..."
                        style="flex: 1; min-width: 200px; padding: 0.75rem; border: 1px solid #333; background: #1a1a1a; color: white; border-radius: 8px;">
                    <select id="gradeFilter"
                        style="padding: 0.75rem; border: 1px solid #333; background: #1a1a1a; color: white; border-radius: 8px;">
                        <option value="all">Todas as Classifica√ß√µes</option>
                        <option value="SÎì±Í∏â">Classe S (Premium)</option>
                        <option value="AÎì±Í∏â">Classe A (Excelente)</option>
                        <option value="BÎì±Í∏â">Classe B (Bom)</option>
                        <option value="CÎì±Í∏â">Classe C (Regular)</option>
                    </select>
                    <select id="sortBy"
                        style="padding: 0.75rem; border: 1px solid #333; background: #1a1a1a; color: white; border-radius: 8px;">
                        <option value="yield">Ordenar por Rendimento</option>
                        <option value="ticker">Ordenar por Ticker</option>
                        <option value="grade">Ordenar por Classifica√ß√£o</option>
                    </select>
                </div>

                <div style="overflow-x: auto;">
                    <table id="dividendTable"
                        style="width: 100%; border-collapse: collapse; margin-top: 1rem; background: #1a1a1a; border-radius: 12px; overflow: hidden;">
                        <thead style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                            <tr style="color: white; text-align: left;">
                                <th style="padding: 1rem;">Ticker</th>
                                <th style="padding: 1rem;">Empresa</th>
                                <th style="padding: 1rem; text-align: right;">Yield</th>
                                <th style="padding: 1rem; text-align: center;">Classe</th>
                            </tr>
                        </thead>
                        <tbody id="dividendTableBody">
                            <tr>
                                <td colspan="4" style="padding: 2rem; text-align: center; color: #666;">
                                    Carregando dados de dividendos...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <p id="stockCount" style="margin-top: 1rem; color: #666; font-size: 0.9rem; text-align: right;">
                    Exibindo 0 a√ß√µes
                </p>
            </section>
        </main>
        <div class="ad-slot"></div>
        <footer>
            <div class="footer-content">
                <p>&copy; 2026 StockWise.ai - Investimento Inteligente</p>
                <div class="legal-disclaimer">
                    <h4 style="margin-bottom: 0.5rem; font-size: 0.9rem;">‚ö†Ô∏è Aviso Legal</h4>
                    <p style="font-size: 0.85rem; line-height: 1.6;">
                        <strong>Todo o conte√∫do deste site √© apenas para fins informativos e educacionais e n√£o
                            constitui aconselhamento financeiro.</strong><br>
                        Os dividendos e rendimentos podem flutuar e n√£o s√£o garantidos.<br>
                        Desempenho passado n√£o garante retornos futuros.<br>
                        N√£o somos respons√°veis por decis√µes de investimento baseadas nas informa√ß√µes deste site.
                    </p>
                </div>
            </div>
        </footer>
    </div>

    <!-- Script to load Dividend Insights -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            let dividendData = [];

            // DOM Elements
            const tableBody = document.getElementById('dividendTableBody');
            const searchBox = document.getElementById('searchBox');
            const gradeFilter = document.getElementById('gradeFilter');
            const sortBy = document.getElementById('sortBy');
            const stockCount = document.getElementById('stockCount');

            // Grade Badge Component
            const getGradeBadge = (grade) => {
                const colors = {
                    'SÎì±Í∏â': 'background: linear-gradient(135deg, #FFD700 0%, #FDB931 100%); color: black; box-shadow: 0 0 10px rgba(255, 215, 0, 0.5);',
                    'AÎì±Í∏â': 'background: #10B981; color: white;',
                    'BÎì±Í∏â': 'background: #3B82F6; color: white;',
                    'CÎì±Í∏â': 'background: #6B7280; color: white;'
                };
                const style = colors[grade] || 'background: #6B7280; color: white;';

                // Map grade to PT if needed, but keeping internal codes same
                let displayGrade = grade;

                return `<span style="padding: 4px 12px; border-radius: 20px; font-weight: bold; font-size: 0.85rem; ${style}">${displayGrade}</span>`;
            };

            // Render Table
            const renderTable = (data) => {
                tableBody.innerHTML = '';

                if (data.length === 0) {
                    tableBody.innerHTML = `<tr><td colspan="4" style="padding: 2rem; text-align: center; color: #666;">Nenhuma a√ß√£o encontrada.</td></tr>`;
                    stockCount.textContent = `Exibindo 0 a√ß√µes`;
                    return;
                }

                data.forEach(stock => {
                    const row = document.createElement('tr');
                    row.style.borderBottom = '1px solid #333';
                    row.innerHTML = `
                        <td style="padding: 1rem; font-weight: bold; color: #fff;">${stock.ticker}</td>
                        <td style="padding: 1rem; color: #ccc;">${stock.name}</td>
                        <td style="padding: 1rem; text-align: right; color: #4ADE80; font-weight: bold;">${stock.dividend_yield}%</td>
                        <td style="padding: 1rem; text-align: center;">${getGradeBadge(stock.grade)}</td>
                    `;
                    tableBody.appendChild(row);
                });

                stockCount.textContent = `Exibindo ${data.length} a√ß√µes`;
            };

            // Filter and Sort Logic
            const filterAndSort = () => {
                const searchTerm = searchBox.value.toLowerCase();
                const gradeTerm = gradeFilter.value;
                const sortType = sortBy.value;

                let filtered = dividendData.filter(stock => {
                    const matchesSearch = stock.ticker.toLowerCase().includes(searchTerm) ||
                        stock.name.toLowerCase().includes(searchTerm);
                    const matchesGrade = gradeTerm === 'all' || stock.grade === gradeTerm;
                    return matchesSearch && matchesGrade;
                });

                filtered.sort((a, b) => {
                    if (sortType === 'yield') return b.dividend_yield - a.dividend_yield;
                    if (sortType === 'ticker') return a.ticker.localeCompare(b.ticker);
                    if (sortType === 'grade') {
                        const grades = { 'SÎì±Í∏â': 4, 'AÎì±Í∏â': 3, 'BÎì±Í∏â': 2, 'CÎì±Í∏â': 1 };
                        return grades[b.grade] - grades[a.grade];
                    }
                });

                renderTable(filtered);
            };

            // Initial Load - relative path
            fetch('../dividend_insights.json')
                .then(response => response.json())
                .then(data => {
                    dividendData = data.stocks;
                    filterAndSort(); // Initial render
                })
                .catch(err => {
                    console.error('Error loading dividend data:', err);
                    tableBody.innerHTML = `<tr><td colspan="4" style="padding: 2rem; text-align: center; color: #ef4444;">Falha ao carregar dados. Tente novamente mais tarde.</td></tr>`;
                });

            // Event Listeners
            searchBox.addEventListener('input', filterAndSort);
            gradeFilter.addEventListener('change', filterAndSort);
            sortBy.addEventListener('change', filterAndSort);
        });
    </script>
</body>

</html>